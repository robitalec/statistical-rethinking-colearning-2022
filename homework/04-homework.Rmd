---
output: 
  github_document:
    html_preview: false
title: Homework Week 04
author: Alec L. Robitaille
date: 2022-03-04
---


```{r}
#| include = FALSE
knitr::opts_knit$set(root.dir = '../.')
```

```{r}
#| include = FALSE
source('R/packages.R')
source('R/dag_plot.R')
source('R/plot_halfeye.R')

knitr::opts_chunk$set(
	echo = FALSE,
	fig.path = '../graphics/homework/'
)


theme_set(theme_bw(base_size = 16))
```


## Question 1

Marriage is a collider between age and happiness. If we include marriage 
as a predictor, it will generate an association between age and happiness.

```{r h04_q01_dag}
dag <- dagify(
  Marriage ~ Happiness + Age,
  exposure = 'Age',
  outcome = 'Happiness'
)
dag_plot(dag, 'graphics/homework/dot_h04_q01')
```

```{r h04_q01_loo}
print('Model 1: Happiness ~ intercept[marriage index] + age')
tar_read(loo_m609)

print('Model 2: Happiness ~ intercept + age')
tar_read(loo_m610)

print('Compared')
tar_read(compare_h04_q01)
```

The PSIS LOO results indicating that the model that includes marriage
has more predictive power, it does not indicate that the causal structure
or potential confounds are correctly accounted for in the model. 
Marriage status is a collider, creating a statistical association between
age and happiness, and when removed from the model, there is no longer an
association between these variables. 

```{r h04_q01_params}
print('Model 1: Happiness ~ intercept[marriage index] + age')
precis(data.table(tar_read(h04_q01_m609_draws_h04_q01_m609))[, .(sigma, beta_age, `alpha[1]`, `alpha[2]`)], depth = 2)

print('Model 2: Happiness ~ intercept + age')
precis(data.table(tar_read(h04_q01_m610_draws_h04_q01_m610))[, .(sigma, beta_age, alpha)])
```

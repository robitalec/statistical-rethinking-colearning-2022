---
title: "Homework week 01"
author: "Hannah Adams"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# load packages
library(rethinking)
library(ggplot2)
```

# Question 1

Suppose the globe tossing data had turned out to be 4 water and 11 land. Construct the posterior distribution, using grid approximation. Use the same flat prior as in the book.

```{r q1}

# set grid size and define grid
gridsize=1000
p_grid <- seq( from=0 , to=1 , length.out=gridsize )

# define prior probability (flat line, all 1)
p_prob <- rep( 1 , gridsize )

# compute likelihood at each value in grid
water<- 4
land<- 11
likelihood <- dbinom(water,water+land , prob=p_grid )

# compute product of likelihood and prior probability
unstd.posterior <- likelihood * p_prob

# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)

# plot
plot(p_grid , posterior , type="l", xlab="proportion of water" , ylab="posterior probability")
```

# Question 2
Suppose the data are 4 water and 2 land. Compute the posterior again, but this time use a prior that is zero below p=0.5 an a constant above p=0.5. This corresponds to a prior information that a majority of the Earth's surface is water.

```{r q2}

# set grid size and define grid
gridsize=1000
p_grid <- seq( from=0 , to=1 , length.out=gridsize )

# define prior probability (0 below p=0.5, constant above p=0.5)
p_prob <- ifelse(p_grid<0.5, 0, 1)

# compute likelihood at each value in grid
water<- 4
land<- 2
likelihood <- dbinom(water,water+land , prob=p_grid )

# compute product of likelihood and prior probability
unstd.posterior <- likelihood * p_prob

# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)

# display the posterior distribution
plot( p_grid , posterior , type="l", xlab="proportion of water" , ylab="posterior probability" )
```

# Question 3
For the posterior distribution from 2, compute 89% percentile and HPDOI intervals. Compare widths, which is wider? Why? If you had only the information of the interval, what might you misunderstand about the shape of the posterior distribution?


```{r q3}
# sample from the posterior distribution
samples <- sample(p_grid, size = gridsize, prob = posterior, replace = TRUE)
mean(samples)

# calculate percentile intervals
sample_pi <- PI(samples)

# calculate highest posterior density interval
sample_hdpi <- HPDI(samples, 0.89)

# plot the distribution of samples and the two intervals
ggplot() + geom_line(aes(p_grid, posterior)) +
  geom_linerange(aes(xmin = min(sample_pi), xmax = max(sample_pi), y = 0.0033, color = 'PI'), 
                 size = 3, data = as.data.frame(sample_pi))+ xlab('Proportion water') +
  geom_linerange(aes(xmin = min(sample_hdpi), xmax = max(sample_hdpi), y = 0.0036, color = 'HDPI'), 
                 size = 3, data = as.data.frame(sample_pi))+ xlab('Proportion water') +
  ylab('Posterior probability') + scale_color_manual(values = list('PI' = 'turquoise3', 'HDPI' = 'goldenrod3'), name = 'Interval')

```

The percentile interval assigns the probability mass to the centre of the distribution (and an equal probability mass to each tail), while the highest posterior density interval contains the greatest posterior probability. 

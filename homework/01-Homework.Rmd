---
title: "01-Homework"
output: github_document
---


# Statistical Rethinking Workshop 2022
## Homework 01

Question 1 - Suppose the globe tossing data (Chapter 2) had turned out to be 4 water and 11 land. Construct the posterior distribution, using grid approximation. Use the same flat prior as in the book.

```{r}
# define grid
p_grid <-seq(from=0, to=1, length.out=20)
# define prior
prior <-rep(1,20)
# compute likelihood at each value in grid
likelihood <-dbinom(4, size=15, prob=p_grid)
# compute product of likelihood and prior
unstd.posterior <-likelihood*prior
# standardize the posterior, so it sums to 1
posterior <-unstd.posterior/sum(unstd.posterior)

plot(p_grid, posterior, type="b", xlab="probability ofwater",ylab="posteriorprobability")
mtext("20points")
```

2. Now suppose the data are 4 water and 2 land. Compute the posterior
again, but this time use a prior that is zero below p = 0.5 and a constant
above p = 0.5. This corresponds to prior information that a majority of the
Earth’s surface is water.
```{r}
# define grid
p_grid <-seq(from=0, to=1, length.out=20)
# define prior
prior <- ifelse(p_grid < 0.5, 0, 1)
# compute likelihood at each value in grid
likelihood <-dbinom(4, size=6, prob= p_grid)
# compute product of likelihood and prior
unstd.posterior <-likelihood*prior
# standardize the posterior, so it sums to 1
posterior <-unstd.posterior/sum(unstd.posterior)

plot(p_grid, posterior, type="b", xlab="probability ofwater",ylab="posteriorprobability")
mtext("20points")
```

3. For the posterior distribution from 2, compute 89% percentile and HPDI
intervals. Compare the widths of these intervals. Which is wider? Why? If
you had only the information in the interval, what might you misunderstand
about the shape of the posterior distribution?

```{r}
library(rethinking)
# define grid
p_grid <-seq(from=0, to=1, length.out=20)
# define prior
prior <- ifelse(p_grid < 0.5, 0, 1)
# compute likelihood at each value in grid
likelihood <-dbinom(4, size=6, prob= p_grid)
# compute product of likelihood and prior
unstd.posterior <-likelihood*prior
# standardize the posterior, so it sums to 1
posterior <-unstd.posterior/sum(unstd.posterior)

samples <-sample(p_grid, size=1e4, replace=TRUE, prob=posterior)

PI(samples, prob = 0.89)
HPDI(samples, prob=0.89)

```

The 89% interval is wider because it provides equal tails on either end and provides the central 89% probability. In contrast, the HDPI provides the narrowest interval containing the specified probability mass, i.e., the densest of all possible intervals. This is the better to use when data is skewed.


4. OPTIONAL CHALLENGE. Suppose there is bias in sampling so that Land
is more likely than Water to be recorded. Specifically, assume that 1-in-5
(20%) of Water samples are accidentally recorded instead as ”Land”. First,
write a generative simulation of this sampling process. Assuming the true
proportion of Water is 0.70, what proportion does your simulation tend to
produce instead? Second, using a simulated sample of 20 tosses, compute
the unbiased posterior distribution of the true proportion of water.